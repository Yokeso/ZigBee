###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.40194/W32 for 8051         03/Jan/2021  22:17:28 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\Source\Tr #
#                          ansmitAppTempLight.c                               #
#    Command line       =  -f D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2 #
#                          530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530 #
#                          DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg            #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f D:\Projects_IAR\IAR_C8051\W #
#                          SN-CC2530\ZStack-CC2530-2.5.1a_EB\Projects\zstack\ #
#                          MY_BOARD\Exp4\CC2530DB\..\..\..\Tools\CC2530DB\f8w #
#                          Config.cfg (-DZIGBEEPRO -DSECURE=0                 #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x02000000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x1001                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 D:\Projects_IAR\IAR_C8051\W #
#                          SN-CC2530\ZStack-CC2530-2.5.1a_EB\Projects\zstack\ #
#                          MY_BOARD\Exp4\Source\TransmitAppTempLight.c -D     #
#                          HAL_UART=TRUE -D HAL_UART_TEST -D xPOWER_SAVING    #
#                          -lC D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC #
#                          2530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC253 #
#                          0DB\EndDeviceSBTempLight\List\ -lA                 #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          EndDeviceSBTempLight\List\ --diag_suppress         #
#                          Pe001,Pa010 -o D:\Projects_IAR\IAR_C8051\WSN-CC253 #
#                          0\ZStack-CC2530-2.5.1a_EB\Projects\zstack\MY_BOARD #
#                          \Exp4\CC2530DB\EndDeviceSBTempLight\Obj\ -e        #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2 #
#                          530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530 #
#                          DB\ -I D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack #
#                          -CC2530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC #
#                          2530DB\..\Source\ -I D:\Projects_IAR\IAR_C8051\WSN #
#                          -CC2530\ZStack-CC2530-2.5.1a_EB\Projects\zstack\MY #
#                          _BOARD\Exp4\CC2530DB\..\..\..\ZMain\TI2530DB\ -I   #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\hal\include\ -I          #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\hal\target\CC2530SB\ -I  #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\include\ -I          #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\high_level\ -I       #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\low_level\srf04\ -I  #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\low_level\srf04\sing #
#                          le_chip\ -I D:\Projects_IAR\IAR_C8051\WSN-CC2530\Z #
#                          Stack-CC2530-2.5.1a_EB\Projects\zstack\MY_BOARD\Ex #
#                          p4\CC2530DB\..\..\..\..\..\Components\mt\ -I       #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\osal\include\ -I         #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\services\saddr\ -I       #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\services\sdata\ -I       #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\af\ -I             #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\nwk\ -I            #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\sapi\ -I           #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\sec\ -I            #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\sys\ -I            #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\zdo\ -I            #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\zmac\ -I                 #
#                          D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          ..\..\..\..\..\Components\zmac\f8w\ -Ohz           #
#    List file          =  D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          EndDeviceSBTempLight\List\TransmitAppTempLight.lst #
#    Object file        =  D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530 #
#                          -2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\CC2530DB\ #
#                          EndDeviceSBTempLight\Obj\TransmitAppTempLight.r51  #
#                                                                             #
#                                                                             #
###############################################################################

D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\Source\TransmitAppTempLight.c
      1          /*******************************************************************************
      2            文 件 名：TransmitTempLight.c
      3            作    者：南京安宸博研电子科技有限公司
      4            创建时间：2013.9.20
      5            修改时间：2020.12.22
      6            IAR 版本：IAR for 8051 V8.10.1
      7            测试平台：MotherBoard V2.1
      8          
      9            说    明：
     10            1、这个应用主要用来采集温度(DS18B20)和光照(BH1750)信息，每秒采集一次并直接发送
     11               给协调器；程序的驱动文件在hal_ds18b20.c、hal_bh1750.c。
     12          
     13            2、本部分的程序使用了以下的编译选项：
     14               HAL_UART=TRUE
     15               HAL_UART_TEST
     16               xPOWER_SAVING (该选项没有打开)
     17               
     18               HAL_UART_TEST是为用户增加的编译选项，该选项主要是为了解决在没有LCD的设备上
     19               观察Z-Stack输出的显示数据。在有LCD的设备上打开LCD_SUPPORTED可以观察网络ID等
     20               一些基本的信息，打开这个编译选项，有类似的效果。可借助串口显示一些原本在LCD
     21               上显示的信息，如果串口有其他用途，可通过关闭此编译选项来关闭串口输出的数据。
     22               
     23               xPOWER_SAVING选项是终端设备(EndDevice)可以打开的编译选项。
     24          
     25            3、程序使用了以下两个事件：
     26               TRANSMITAPP_SEND_MSG_EVT(发送数据)
     27               TRANSMITAPP_MATCHRSP_EVT(描述符匹配)
     28          
     29            4、按键处理函数在TransmitApp_HandleKeys( byte shift, byte keys )，在本应用中没
     30               有使用按键SW5，即按键功能预留。
     31          
     32            5、设备自动加入网络，通过描述符匹配事件对目标设备的网络地址进行查询，当匹配成
     33               功后，关闭该事件的定时器，保存目标设备的网络地址，接着打开发送数据事件，周
     34               期性地发送数据。发送数据的时间间隔由宏定义TRANSMITAPP_SEND_DELAY设置，修改
     35               此宏定义即可修改设备发送数据的周期。
     36               注意：设备发送数据的周期与协调器的离线检测功能是关联的，如果此处的发送间隔
     37               时间过长(大于6s)，那么协调器就会认定设备离线。因此，修改时间间隔需要与协调
     38               器的离线检测功能协调一致。
     39          *******************************************************************************/
     40          
     41          /*******************************************************************************
     42           * INCLUDES
     43           */
     44          #include "OSAL.h"
     45          #include "AF.h"
     46          #include "ZDObject.h"
     47          #include "ZDProfile.h"
     48          
     49          #include "TransmitApp.h"
     50          #include "OnBoard.h"
     51          
     52          #include "DebugTrace.h"
     53          
     54          #include <string.h>
     55          
     56          /* HAL */
     57          #include "hal_led.h"
     58          #include "hal_key.h"
     59          #include "hal_uart.h"
     60          #include "hal_ds18b20.h"
     61          #include "hal_bh1750.h"
     62          
     63          /*******************************************************************************
     64           * MACROS
     65           */
     66          #define TRANSMITAPP_STATE_WAITING   0
     67          #define TRANSMITAPP_STATE_SENDING   1
     68          
     69          #define TRANSMITAPP_SEND_DELAY      1000
     70          
     71          // Send with or without APS ACKs
     72          #define TRANSMITAPP_TX_OPTIONS    AF_DISCV_ROUTE
     73          
     74          #define TRANSMITAPP_MATCH_DELAY     1000
     75          
     76          /*******************************************************************************
     77           * TYPEDEFS
     78           */
     79          
     80          /*******************************************************************************
     81           * GLOBAL VARIABLES
     82           */
     83          
     84          // This is the buffer that is sent out as data.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     85          byte TransmitApp_Msg[ TRANSMITAPP_TEMPLIGHT_DATA_LEN ];
   \                     TransmitApp_Msg:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
     86          
     87          // This is the Cluster ID List and should be filled with Application
     88          // specific cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
     89          const cId_t TransmitApp_InClusterList[1] =
   \                     TransmitApp_InClusterList:
   \   000000   0900         DW 9
     90          {
     91            TRANSMITAPP_CLUSTERID_TESTMSG       // MSG Cluster ID
     92          };
     93          

   \                                 In  segment XDATA_ROM_C, align 1
     94          const cId_t TransmitApp_OutClusterList[1] =
   \                     TransmitApp_OutClusterList:
   \   000000   0200         DW 2
     95          {
     96            TRANSMITAPP_CLUSTERID_TEMPLIGHTMSG  // MSG Cluster ID
     97          };
     98          

   \                                 In  segment XDATA_ROM_C, align 1
     99          const SimpleDescriptionFormat_t TransmitApp_SimpleDesc =
   \                     TransmitApp_SimpleDesc:
   \   000000   01           DB 1
   \   000001   050F         DW 3845
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   08           DB 8
   \   000007   ....         DW TransmitApp_InClusterList
   \   000009   03           DB 3
   \   00000A   ....         DW TransmitApp_OutClusterList
    100          {
    101            TRANSMITAPP_ENDPOINT,                 //  int    Endpoint;
    102            TRANSMITAPP_PROFID,                   //  uint16 AppProfId[2];
    103            TRANSMITAPP_DEVICEID,                 //  uint16 AppDeviceId[2];
    104            TRANSMITAPP_DEVICE_VERSION,           //  int    AppDevVer:4;
    105            TRANSMITAPP_FLAGS,                    //  int    AppFlags:4;
    106            TRANSMITAPP_MAX_INCLUSTERS,           //  byte   AppNumInClusters;
    107            (cId_t *)TransmitApp_InClusterList,   //  byte   *pAppInClusterList;
    108            TRANSMITAPP_MAX_OUTCLUSTERS,          //  byte   AppNumOutClusters;
    109            (cId_t *)TransmitApp_OutClusterList   //  byte   *pAppOutClusterList;
    110          };
    111          
    112          // This is the Endpoint/Interface description.  It is defined here, but
    113          // filled-in in TransmitApp_Init().  Another way to go would be to fill
    114          // in the structure here and make it a "const" (in code space).  The
    115          // way it's defined in this sample app it is define in RAM.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    116          endPointDesc_t TransmitApp_epDesc;
   \                     TransmitApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    117          
    118          /*******************************************************************************
    119           * EXTERNAL VARIABLES
    120           */
    121          
    122          /*******************************************************************************
    123           * EXTERNAL FUNCTIONS
    124           */
    125          
    126          /*******************************************************************************
    127           * LOCAL VARIABLES
    128           */
    129          #if !defined( SERIAL_APP_PORT )
    130          #define SERIAL_APP_PORT  0
    131          #endif
    132          
    133          #if !defined( SERIAL_APP_BAUD )
    134          #define SERIAL_APP_BAUD  HAL_UART_BR_38400
    135          #endif
    136          
    137          // When the Rx buf space is less than this threshold, invoke the Rx callback.
    138          #if !defined( SERIAL_APP_THRESH )
    139          #define SERIAL_APP_THRESH  64
    140          #endif
    141          
    142          #if !defined( SERIAL_APP_RX_SZ )
    143          #define SERIAL_APP_RX_SZ  128
    144          #endif
    145          
    146          #if !defined( SERIAL_APP_TX_SZ )
    147          #define SERIAL_APP_TX_SZ  128
    148          #endif
    149          
    150          // Millisecs of idle time after a byte is received before invoking Rx callback.
    151          #if !defined( SERIAL_APP_IDLE )
    152          #define SERIAL_APP_IDLE  6
    153          #endif
    154          
    155          // Loopback Rx bytes to Tx for throughput testing.
    156          #if !defined( SERIAL_APP_LOOPBACK )
    157          #define SERIAL_APP_LOOPBACK  FALSE
    158          #endif
    159          
    160          // This is the max byte count per OTA message.
    161          #if !defined( SERIAL_APP_TX_MAX )
    162          #define SERIAL_APP_TX_MAX  80
    163          #endif
    164          
    165          #define SERIAL_APP_RSP_CNT  4
    166          
    167          // Task ID for event processing - received when TransmitApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    168          byte TransmitApp_TaskID;
   \                     TransmitApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    169          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    170          devStates_t TransmitApp_NwkState;
   \                     TransmitApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    171          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    172          static byte TransmitApp_TransID;  // This is the unique message ID (counter)
   \                     TransmitApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    173          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    174          afAddrType_t TransmitApp_DstAddr;
   \                     TransmitApp_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    175          
    176          
    177          /*******************************************************************************
    178           * LOCAL FUNCTIONS
    179           */
    180          void TransmitApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    181          void TransmitApp_HandleKeys( byte shift, byte keys );
    182          void TransmitApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );
    183          void TransmitApp_SendTheMessage( void );
    184          void TransmitApp_ChangeState( void );
    185          static void TransmitAPP_CallBack(uint8 port, uint8 event);
    186          
    187          /*******************************************************************************
    188           * NETWORK LAYER CALLBACKS
    189           */
    190          
    191          /*******************************************************************************
    192           * PUBLIC FUNCTIONS
    193           */
    194          void TransmitApp_DisplayResults( void );
    195          
    196          /*******************************************************************************
    197           * @fn      TransmitApp_Init
    198           *
    199           * @brief   Initialization function for the Generic App Task.
    200           *          This is called during initialization and should contain
    201           *          any application specific initialization (ie. hardware
    202           *          initialization/setup, table initialization, power up
    203           *          notificaiton ... ).
    204           *
    205           * @param   task_id - the ID assigned by OSAL.  This ID should be
    206           *                    used to send messages and set timers.
    207           *
    208           * @return  none
    209           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    210          void TransmitApp_Init( byte task_id )
   \                     TransmitApp_Init:
    211          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 29
   \   000005   74E3         MOV     A,#-0x1d
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    212            uint16 i;
    213            
    214          #if HAL_UART==TRUE
    215            halUARTCfg_t uartConfig;
    216            
    217            uartConfig.configured           = TRUE;              // 2x30 don't care - see uart driver.
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   7401         MOV     A,#0x1
   \   000014   F0           MOVX    @DPTR,A
    218            uartConfig.baudRate             = SERIAL_APP_BAUD;
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   7402         MOV     A,#0x2
   \   00001A   F0           MOVX    @DPTR,A
    219            uartConfig.flowControl          = FALSE;
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   E4           CLR     A
   \   00001F   F0           MOVX    @DPTR,A
    220            uartConfig.flowControlThreshold = SERIAL_APP_THRESH; // 2x30 don't care - see uart driver.
   \   000020   7403         MOV     A,#0x3
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   7440         MOV     A,#0x40
   \   000027   F0           MOVX    @DPTR,A
   \   000028   A3           INC     DPTR
   \   000029   E4           CLR     A
   \   00002A   F0           MOVX    @DPTR,A
    221            uartConfig.rx.maxBufSize        = SERIAL_APP_RX_SZ;  // 2x30 don't care - see uart driver.
   \   00002B   740A         MOV     A,#0xa
   \   00002D   12....       LCALL   ?XSTACK_DISP0_8
   \   000030   7480         MOV     A,#-0x80
   \   000032   F0           MOVX    @DPTR,A
   \   000033   A3           INC     DPTR
   \   000034   E4           CLR     A
   \   000035   F0           MOVX    @DPTR,A
    222            uartConfig.tx.maxBufSize        = SERIAL_APP_TX_SZ;  // 2x30 don't care - see uart driver.
   \   000036   7412         MOV     A,#0x12
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   7480         MOV     A,#-0x80
   \   00003D   F0           MOVX    @DPTR,A
   \   00003E   A3           INC     DPTR
   \   00003F   E4           CLR     A
   \   000040   F0           MOVX    @DPTR,A
    223            uartConfig.idleTimeout          = SERIAL_APP_IDLE;   // 2x30 don't care - see uart driver.
   \   000041   7405         MOV     A,#0x5
   \   000043   12....       LCALL   ?XSTACK_DISP0_8
   \   000046   7406         MOV     A,#0x6
   \   000048   F0           MOVX    @DPTR,A
    224            uartConfig.intEnable            = FALSE;             // 2x30 don't care - see uart driver.
   \   000049   7416         MOV     A,#0x16
   \   00004B   12....       LCALL   ?XSTACK_DISP0_8
   \   00004E   E4           CLR     A
   \   00004F   F0           MOVX    @DPTR,A
    225            uartConfig.callBackFunc         = TransmitAPP_CallBack;
   \   000050   741B         MOV     A,#0x1b
   \   000052   12....       LCALL   ?XSTACK_DISP0_8
   \   000055   74..         MOV     A,#??TransmitAPP_CallBack?relay & 0xff
   \   000057   F0           MOVX    @DPTR,A
   \   000058   A3           INC     DPTR
   \   000059   74..         MOV     A,#(??TransmitAPP_CallBack?relay >> 8) & 0xff
   \   00005B   F0           MOVX    @DPTR,A
    226            HalUARTOpen (HAL_UART_PORT_0, &uartConfig);
   \   00005C                ; Setup parameters for call to function HalUARTOpen
   \   00005C   85..82       MOV     DPL,?XSP + 0
   \   00005F   85..83       MOV     DPH,?XSP + 1
   \   000062   AA82         MOV     R2,DPL
   \   000064   AB83         MOV     R3,DPH
   \   000066   7900         MOV     R1,#0x0
   \   000068   12....       LCALL   ??HalUARTOpen?relay
    227          #endif
    228          
    229            TransmitApp_TaskID = task_id;
   \   00006B   EE           MOV     A,R6
   \   00006C   90....       MOV     DPTR,#TransmitApp_TaskID
   \   00006F   F0           MOVX    @DPTR,A
    230            TransmitApp_NwkState = DEV_INIT;
   \   000070   90....       MOV     DPTR,#TransmitApp_NwkState
   \   000073   7401         MOV     A,#0x1
   \   000075   F0           MOVX    @DPTR,A
    231            TransmitApp_TransID = 0;
   \   000076   90....       MOV     DPTR,#TransmitApp_TransID
   \   000079   E4           CLR     A
   \   00007A   F0           MOVX    @DPTR,A
    232              
    233            // Device hardware initialization can be added here or in main() (Zmain.c).
    234            // If the hardware is application specific - add it here.
    235            // If the hardware is other parts of the device add it in main().
    236            TransmitApp_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   00007B   90....       MOV     DPTR,#TransmitApp_DstAddr + 8
   \   00007E   F0           MOVX    @DPTR,A
    237            TransmitApp_DstAddr.endPoint = 0;
   \   00007F   A3           INC     DPTR
   \   000080   F0           MOVX    @DPTR,A
    238            TransmitApp_DstAddr.addr.shortAddr = 0;
   \   000081   90....       MOV     DPTR,#TransmitApp_DstAddr
   \   000084   F0           MOVX    @DPTR,A
   \   000085   A3           INC     DPTR
   \   000086   F0           MOVX    @DPTR,A
    239            
    240            // Fill out the endpoint description.
    241            TransmitApp_epDesc.endPoint = TRANSMITAPP_ENDPOINT;
   \   000087   90....       MOV     DPTR,#TransmitApp_epDesc
   \   00008A   04           INC     A
   \   00008B   F0           MOVX    @DPTR,A
    242            TransmitApp_epDesc.task_id = &TransmitApp_TaskID;
   \   00008C   A3           INC     DPTR
   \   00008D   74..         MOV     A,#TransmitApp_TaskID & 0xff
   \   00008F   F0           MOVX    @DPTR,A
   \   000090   A3           INC     DPTR
   \   000091   74..         MOV     A,#(TransmitApp_TaskID >> 8) & 0xff
   \   000093   F0           MOVX    @DPTR,A
    243            TransmitApp_epDesc.simpleDesc
    244                    = (SimpleDescriptionFormat_t *)&TransmitApp_SimpleDesc;
   \   000094   A3           INC     DPTR
   \   000095   74..         MOV     A,#TransmitApp_SimpleDesc & 0xff
   \   000097   F0           MOVX    @DPTR,A
   \   000098   A3           INC     DPTR
   \   000099   74..         MOV     A,#(TransmitApp_SimpleDesc >> 8) & 0xff
   \   00009B   F0           MOVX    @DPTR,A
    245            TransmitApp_epDesc.latencyReq = noLatencyReqs;
   \   00009C   A3           INC     DPTR
   \   00009D   E4           CLR     A
   \   00009E   F0           MOVX    @DPTR,A
    246            
    247            // Register the endpoint/interface description with the AF
    248            afRegister( &TransmitApp_epDesc );
   \   00009F                ; Setup parameters for call to function afRegister
   \   00009F   7A..         MOV     R2,#TransmitApp_epDesc & 0xff
   \   0000A1   7B..         MOV     R3,#(TransmitApp_epDesc >> 8) & 0xff
   \   0000A3   12....       LCALL   ??afRegister?relay
    249            
    250            // Register for all key events - This app will handle all key events
    251            RegisterForKeys( TransmitApp_TaskID );
   \   0000A6                ; Setup parameters for call to function RegisterForKeys
   \   0000A6   90....       MOV     DPTR,#TransmitApp_TaskID
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   F9           MOV     R1,A
   \   0000AB   12....       LCALL   ??RegisterForKeys?relay
    252              
    253            // Generate the data
    254            for (i = 0; i < TRANSMITAPP_TEMPLIGHT_DATA_LEN; i++)
    255            {
    256              TransmitApp_Msg[i] = 0;
   \   0000AE   E4           CLR     A
   \   0000AF   90....       MOV     DPTR,#TransmitApp_Msg
   \   0000B2   7808         MOV     R0,#0x8
   \                     ??TransmitApp_Init_0:
   \   0000B4   F0           MOVX    @DPTR,A
   \   0000B5   A3           INC     DPTR
   \   0000B6   D8FC         DJNZ    R0,??TransmitApp_Init_0
    257            }
    258            
    259            ZDO_RegisterForZDOMsg( TransmitApp_TaskID, End_Device_Bind_rsp );
   \   0000B8                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   0000B8   7A20         MOV     R2,#0x20
   \   0000BA   7B80         MOV     R3,#-0x80
   \   0000BC   90....       MOV     DPTR,#TransmitApp_TaskID
   \   0000BF   E0           MOVX    A,@DPTR
   \   0000C0   F9           MOV     R1,A
   \   0000C1   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    260            ZDO_RegisterForZDOMsg( TransmitApp_TaskID, Match_Desc_rsp );
   \   0000C4                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   0000C4   7A06         MOV     R2,#0x6
   \   0000C6   7B80         MOV     R3,#-0x80
   \   0000C8   90....       MOV     DPTR,#TransmitApp_TaskID
   \   0000CB   E0           MOVX    A,@DPTR
   \   0000CC   F9           MOV     R1,A
   \   0000CD   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    261            
    262            osal_start_reload_timer( TransmitApp_TaskID, TRANSMITAPP_MATCHRSP_EVT, 
    263                                                         TRANSMITAPP_MATCH_DELAY );
   \   0000D0                ; Setup parameters for call to function osal_start_reload_timer
   \   0000D0   7CE8         MOV     R4,#-0x18
   \   0000D2   7D03         MOV     R5,#0x3
   \   0000D4   7A08         MOV     R2,#0x8
   \   0000D6   7B00         MOV     R3,#0x0
   \   0000D8   90....       MOV     DPTR,#TransmitApp_TaskID
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   F9           MOV     R1,A
   \   0000DD   12....       LCALL   ??osal_start_reload_timer?relay
    264          }
   \   0000E0   741D         MOV     A,#0x1d
   \   0000E2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E5   7F01         MOV     R7,#0x1
   \   0000E7   02....       LJMP    ?BANKED_LEAVE_XDATA
    265          
    266          /*******************************************************************************
    267           * @fn      TransmitApp_ProcessEvent
    268           *
    269           * @brief   Generic Application Task event processor.  This function
    270           *          is called to process all events for the task.  Events
    271           *          include timers, messages and any other user defined events.
    272           *
    273           * @param   task_id  - The OSAL assigned task ID.
    274           * @param   events - events to process.  This is a bit map and can
    275           *                   contain more than one event.
    276           *
    277           * @return  none
    278           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    279          UINT16 TransmitApp_ProcessEvent( byte task_id, UINT16 events )
   \                     TransmitApp_ProcessEvent:
    280          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    281            afIncomingMSGPacket_t *MSGpkt;
    282            afDataConfirm_t *afDataConfirm;
    283            (void)task_id;  // Intentionally unreferenced parameter
    284          
    285            // Data Confirmation message fields
    286            ZStatus_t sentStatus;
    287            byte sentEP;
    288          
    289            if ( events & SYS_EVENT_MSG )
   \   00000E   5480         ANL     A,#0x80
   \   000010   6042         JZ      ??TransmitApp_ProcessEvent_0
    290            {
    291              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( TransmitApp_TaskID );
   \   000012                ; Setup parameters for call to function osal_msg_receive
   \   000012   800D         SJMP    ??TransmitApp_ProcessEvent_1
    292              while ( MSGpkt )
    293              {
    294                switch ( MSGpkt->hdr.event )
    295                {
    296                  case ZDO_CB_MSG:
    297                    TransmitApp_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
    298                    break;
    299          
    300                  case KEY_CHANGE:
    301                    TransmitApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    302                    break;
    303          
    304                  case AF_DATA_CONFIRM_CMD:
    305                    // This message is received as a confirmation of a data packet sent.
    306                    // The status is of ZStatus_t type [defined in ZComDef.h]
    307                    // The message fields are defined in AF.h
    308                    afDataConfirm = (afDataConfirm_t *)MSGpkt;
    309                    sentEP = afDataConfirm->endpoint;
    310                    sentStatus = afDataConfirm->hdr.status;
    311          
    312                    if ( (ZSuccess == sentStatus) && (TransmitApp_epDesc.endPoint == sentEP) )
    313                    {
    314                    }
    315          
    316                    // Action taken when confirmation is received: Send the next message.
    317                    TransmitApp_SetSendEvt();
    318                    break;
    319          
    320                  case AF_INCOMING_MSG_CMD:
    321                    TransmitApp_MessageMSGCB( MSGpkt );
    322                    break;
    323          
    324                  case ZDO_STATE_CHANGE:
    325                    TransmitApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??TransmitApp_ProcessEvent_2:
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   90....       MOV     DPTR,#TransmitApp_NwkState
   \   000019   F0           MOVX    @DPTR,A
    326                    break;
    327          
    328                  default:
    329                    break;
    330                }
    331          
    332                // Release the memory
    333                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??TransmitApp_ProcessEvent_3:
   \   00001A                ; Setup parameters for call to function osal_msg_deallocate
   \   00001A   AA..         MOV     R2,?V0 + 0
   \   00001C   AB..         MOV     R3,?V0 + 1
   \   00001E   12....       LCALL   ??osal_msg_deallocate?relay
    334          
    335                // Next
    336                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( TransmitApp_TaskID );
   \   000021                ; Setup parameters for call to function osal_msg_receive
   \                     ??TransmitApp_ProcessEvent_1:
   \   000021   90....       MOV     DPTR,#TransmitApp_TaskID
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F9           MOV     R1,A
   \   000026   12....       LCALL   ??osal_msg_receive?relay
   \   000029   8A..         MOV     ?V0 + 0,R2
   \   00002B   8B..         MOV     ?V0 + 1,R3
   \   00002D   E5..         MOV     A,?V0 + 0
   \   00002F   45..         ORL     A,?V0 + 1
   \   000031   6018         JZ      ??TransmitApp_ProcessEvent_4
   \   000033   85..82       MOV     DPL,?V0 + 0
   \   000036   85..83       MOV     DPH,?V0 + 1
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   242F         ADD     A,#0x2f
   \   00003C   60D6         JZ      ??TransmitApp_ProcessEvent_2
   \   00003E   24FE         ADD     A,#-0x2
   \   000040   70D8         JNZ     ??TransmitApp_ProcessEvent_3
   \   000042                ; Setup parameters for call to function TransmitApp_ProcessZDOMsgs
   \   000042   AA..         MOV     R2,?V0 + 0
   \   000044   AB..         MOV     R3,?V0 + 1
   \   000046   12....       LCALL   ??TransmitApp_ProcessZDOMsgs?relay
   \   000049   80CF         SJMP    ??TransmitApp_ProcessEvent_3
    337              }
    338          
    339              // Squash compiler warnings until values are used.
    340              (void)sentStatus;
    341              (void)sentEP;
    342          
    343              // Return unprocessed events
    344              return (events ^ SYS_EVENT_MSG);
   \                     ??TransmitApp_ProcessEvent_4:
   \   00004B   EE           MOV     A,R6
   \   00004C   FA           MOV     R2,A
   \   00004D   EF           MOV     A,R7
   \   00004E   6480         XRL     A,#0x80
   \                     ??TransmitApp_ProcessEvent_5:
   \   000050   FB           MOV     R3,A
   \   000051   02....       LJMP    ??TransmitApp_ProcessEvent_6 & 0xFFFF
    345            }
    346          
    347            // Send a message out
    348            if ( events & TRANSMITAPP_SEND_MSG_EVT )
   \                     ??TransmitApp_ProcessEvent_0:
   \   000054   EE           MOV     A,R6
   \   000055   A2E0         MOV     C,0xE0 /* A   */.0
   \   000057   500A         JNC     ??TransmitApp_ProcessEvent_7
    349            {
    350                TransmitApp_SendTheMessage();
   \   000059                ; Setup parameters for call to function TransmitApp_SendTheMessage
   \   000059   12....       LCALL   ??TransmitApp_SendTheMessage?relay
    351          
    352              // Return unprocessed events
    353              return (events ^ TRANSMITAPP_SEND_MSG_EVT);
   \   00005C   EE           MOV     A,R6
   \   00005D   6401         XRL     A,#0x1
   \                     ??TransmitApp_ProcessEvent_8:
   \   00005F   FA           MOV     R2,A
   \   000060   EF           MOV     A,R7
   \   000061   80ED         SJMP    ??TransmitApp_ProcessEvent_5
    354            }
    355            
    356            if ( events & TRANSMITAPP_MATCHRSP_EVT )
   \                     ??TransmitApp_ProcessEvent_7:
   \   000063   5408         ANL     A,#0x8
   \   000065   6060         JZ      ??TransmitApp_ProcessEvent_9
    357            {
    358               zAddrType_t dstAddr;
    359               dstAddr.addrMode = AddrBroadcast;
   \   000067   7408         MOV     A,#0x8
   \   000069   12....       LCALL   ?XSTACK_DISP0_8
   \   00006C   740F         MOV     A,#0xf
   \   00006E   F0           MOVX    @DPTR,A
    360               dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
   \   00006F   85..82       MOV     DPL,?XSP + 0
   \   000072   85..83       MOV     DPH,?XSP + 1
   \   000075   74FF         MOV     A,#-0x1
   \   000077   F0           MOVX    @DPTR,A
   \   000078   A3           INC     DPTR
   \   000079   F0           MOVX    @DPTR,A
    361               ZDP_MatchDescReq( &dstAddr, 
    362                                  NWK_BROADCAST_SHORTADDR,
    363                                  TRANSMITAPP_PROFID,
    364                                  TRANSMITAPP_MAX_OUTCLUSTERS, 
    365                                  (cId_t *)TransmitApp_OutClusterList,
    366                                  TRANSMITAPP_MAX_INCLUSTERS, 
    367                                  (cId_t *)TransmitApp_InClusterList,
    368                                  FALSE );
   \   00007A                ; Setup parameters for call to function ZDP_MatchDescReq
   \   00007A   75..00       MOV     ?V0 + 0,#0x0
   \   00007D   78..         MOV     R0,#?V0 + 0
   \   00007F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000082   75....       MOV     ?V0 + 0,#TransmitApp_InClusterList & 0xff
   \   000085   75....       MOV     ?V0 + 1,#(TransmitApp_InClusterList >> 8) & 0xff
   \   000088   78..         MOV     R0,#?V0 + 0
   \   00008A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008D   75..08       MOV     ?V0 + 0,#0x8
   \   000090   78..         MOV     R0,#?V0 + 0
   \   000092   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000095   75....       MOV     ?V0 + 0,#TransmitApp_OutClusterList & 0xff
   \   000098   75....       MOV     ?V0 + 1,#(TransmitApp_OutClusterList >> 8) & 0xff
   \   00009B   78..         MOV     R0,#?V0 + 0
   \   00009D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A0   75..05       MOV     ?V0 + 0,#0x5
   \   0000A3   75..0F       MOV     ?V0 + 1,#0xf
   \   0000A6   78..         MOV     R0,#?V0 + 0
   \   0000A8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000AB   7903         MOV     R1,#0x3
   \   0000AD   7CFF         MOV     R4,#-0x1
   \   0000AF   7DFF         MOV     R5,#-0x1
   \   0000B1   7408         MOV     A,#0x8
   \   0000B3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B6   AA82         MOV     R2,DPL
   \   0000B8   AB83         MOV     R3,DPH
   \   0000BA   12....       LCALL   ??ZDP_MatchDescReq?relay
   \   0000BD   7408         MOV     A,#0x8
   \   0000BF   12....       LCALL   ?DEALLOC_XSTACK8
    369          
    370              // Return unprocessed events
    371              return (events ^ TRANSMITAPP_MATCHRSP_EVT);
   \   0000C2   EE           MOV     A,R6
   \   0000C3   6408         XRL     A,#0x8
   \   0000C5   8098         SJMP    ??TransmitApp_ProcessEvent_8
    372            }
    373          
    374            // Timed wait from error
    375            if ( events & TRANSMITAPP_SEND_ERR_EVT )
   \                     ??TransmitApp_ProcessEvent_9:
   \   0000C7   EE           MOV     A,R6
   \   0000C8   5404         ANL     A,#0x4
   \   0000CA   6006         JZ      ??TransmitApp_ProcessEvent_10
    376            {
    377              TransmitApp_SetSendEvt();
    378          
    379              // Return unprocessed events
    380              return (events ^ TRANSMITAPP_SEND_ERR_EVT);
   \   0000CC   EE           MOV     A,R6
   \   0000CD   6404         XRL     A,#0x4
   \   0000CF   FA           MOV     R2,A
   \   0000D0   8004         SJMP    ??TransmitApp_ProcessEvent_6
    381            }
    382          
    383            // Discard unknown events
    384            return 0;
   \                     ??TransmitApp_ProcessEvent_10:
   \   0000D2   7A00         MOV     R2,#0x0
   \   0000D4   7B00         MOV     R3,#0x0
   \                     ??TransmitApp_ProcessEvent_6:
   \   0000D6   7409         MOV     A,#0x9
   \   0000D8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000DB   7F04         MOV     R7,#0x4
   \   0000DD   02....       LJMP    ?BANKED_LEAVE_XDATA
    385          }
    386          
    387          /*******************************************************************************
    388           * @fn      TransmitApp_ProcessZDOMsgs()
    389           *
    390           * @brief   Process response messages
    391           *
    392           * @param   none
    393           *
    394           * @return  none
    395           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    396          void TransmitApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
   \                     TransmitApp_ProcessZDOMsgs:
    397          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    398            switch ( inMsg->clusterID )
   \   000005   EA           MOV     A,R2
   \   000006   240C         ADD     A,#0xc
   \   000008   F582         MOV     DPL,A
   \   00000A   EB           MOV     A,R3
   \   00000B   3400         ADDC    A,#0x0
   \   00000D   F583         MOV     DPH,A
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   6406         XRL     A,#0x6
   \   000012   7004         JNZ     ??TransmitApp_ProcessZDOMsgs_0
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   6480         XRL     A,#0x80
   \                     ??TransmitApp_ProcessZDOMsgs_0:
   \   000018   7071         JNZ     ??TransmitApp_ProcessZDOMsgs_1
    399            {
    400              case End_Device_Bind_rsp:
    401                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
    402                {
    403                }
    404                break;
    405          
    406              case Match_Desc_rsp:
    407                ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( inMsg );
                       ^
Warning[Pe1072]: a declaration cannot have a label

    switch ( inMsg->clusterID )
    ^
"D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530-2.5.1a_EB\Projects\zstack\MY_BOARD\Exp4\Source\TransmitAppTempLight.c",398  Warning[Pe546]: 
          transfer of control bypasses initialization of:
            variable "pRsp" (declared at line 407 of
                      "D:\Projects_IAR\IAR_C8051\WSN-CC2530\ZStack-CC2530-2.5.1
                      a_EB\Projects\zstack\MY_BOARD\Exp4\Source\TransmitAppTemp
                      Light.c")
   \   00001A                ; Setup parameters for call to function ZDO_ParseEPListRsp
   \   00001A   12....       LCALL   ??ZDO_ParseEPListRsp?relay
   \   00001D   8A..         MOV     ?V0 + 0,R2
   \   00001F   8B..         MOV     ?V0 + 1,R3
   \   000021   AE..         MOV     R6,?V0 + 0
   \   000023   AF..         MOV     R7,?V0 + 1
    408                if ( pRsp )
   \   000025   EE           MOV     A,R6
   \   000026   4F           ORL     A,R7
   \   000027   6062         JZ      ??TransmitApp_ProcessZDOMsgs_1
    409                {
    410                  if ( pRsp->status == ZSuccess && pRsp->cnt )
   \   000029   8E82         MOV     DPL,R6
   \   00002B   8F83         MOV     DPH,R7
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   7054         JNZ     ??TransmitApp_ProcessZDOMsgs_2
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   604E         JZ      ??TransmitApp_ProcessZDOMsgs_2
    411                  {
    412                    // 此处存储绑定对方的地址信息用于发送
    413                    TransmitApp_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000036   90....       MOV     DPTR,#TransmitApp_DstAddr + 8
   \   000039   7402         MOV     A,#0x2
   \   00003B   F0           MOVX    @DPTR,A
    414                    TransmitApp_DstAddr.addr.shortAddr = pRsp->nwkAddr;
   \   00003C   8E82         MOV     DPL,R6
   \   00003E   8F83         MOV     DPH,R7
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F8           MOV     R0,A
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F9           MOV     R1,A
   \   000046   90....       MOV     DPTR,#TransmitApp_DstAddr
   \   000049   E8           MOV     A,R0
   \   00004A   F0           MOVX    @DPTR,A
   \   00004B   A3           INC     DPTR
   \   00004C   E9           MOV     A,R1
   \   00004D   F0           MOVX    @DPTR,A
    415                    // Take the first endpoint, Can be changed to search through endpoints
    416                    TransmitApp_DstAddr.endPoint = pRsp->epList[0];
   \   00004E   8E82         MOV     DPL,R6
   \   000050   8F83         MOV     DPH,R7
   \   000052   A3           INC     DPTR
   \   000053   A3           INC     DPTR
   \   000054   A3           INC     DPTR
   \   000055   A3           INC     DPTR
   \   000056   E0           MOVX    A,@DPTR
   \   000057   90....       MOV     DPTR,#TransmitApp_DstAddr + 9
   \   00005A   F0           MOVX    @DPTR,A
    417                    osal_stop_timerEx( TransmitApp_TaskID, TRANSMITAPP_MATCHRSP_EVT );
   \   00005B                ; Setup parameters for call to function osal_stop_timerEx
   \   00005B   7A08         MOV     R2,#0x8
   \   00005D   7B00         MOV     R3,#0x0
   \   00005F   90....       MOV     DPTR,#TransmitApp_TaskID
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F9           MOV     R1,A
   \   000064   12....       LCALL   ??osal_stop_timerEx?relay
    418          #if HAL_UART==TRUE
    419                    HalUARTWrite(HAL_UART_PORT_0, "Match Success!\n",   strlen("Match Success!\n"));
   \   000067                ; Setup parameters for call to function HalUARTWrite
   \   000067   7C0F         MOV     R4,#0xf
   \   000069   7D00         MOV     R5,#0x0
   \   00006B   7A..         MOV     R2,#`?<Constant "Match Success!\\n">` & 0xff
   \   00006D   7B..         MOV     R3,#(`?<Constant "Match Success!\\n">` >> 8) & 0xff
   \   00006F   7900         MOV     R1,#0x0
   \   000071   12....       LCALL   ??HalUARTWrite?relay
    420          #endif
    421                    osal_start_reload_timer( TransmitApp_TaskID, TRANSMITAPP_SEND_MSG_EVT, 
    422                                             TRANSMITAPP_SEND_DELAY );
   \   000074                ; Setup parameters for call to function osal_start_reload_timer
   \   000074   7CE8         MOV     R4,#-0x18
   \   000076   7D03         MOV     R5,#0x3
   \   000078   7A01         MOV     R2,#0x1
   \   00007A   7B00         MOV     R3,#0x0
   \   00007C   90....       MOV     DPTR,#TransmitApp_TaskID
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   F9           MOV     R1,A
   \   000081   12....       LCALL   ??osal_start_reload_timer?relay
    423                  }
    424          
    425                  osal_mem_free( pRsp );
   \                     ??TransmitApp_ProcessZDOMsgs_2:
   \   000084                ; Setup parameters for call to function osal_mem_free
   \   000084   EE           MOV     A,R6
   \   000085   FA           MOV     R2,A
   \   000086   EF           MOV     A,R7
   \   000087   FB           MOV     R3,A
   \   000088   12....       LCALL   ??osal_mem_free?relay
    426                }
    427                break;
    428                
    429              default:
    430                break;
    431            }
    432          }
   \                     ??TransmitApp_ProcessZDOMsgs_1:
   \   00008B   7F02         MOV     R7,#0x2
   \   00008D   02....       LJMP    ?BANKED_LEAVE_XDATA
    433          
    434          /*******************************************************************************
    435           * @fn      TransmitApp_HandleKeys
    436           *
    437           * @brief   Handles all key events for this device.
    438           *
    439           *
    440           * @return  none
    441           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    442          void TransmitApp_HandleKeys( byte shift, byte keys )
   \                     TransmitApp_HandleKeys:
    443          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    444            if ( keys & HAL_KEY_SW_5 )
    445            {
    446            }
    447          }
   \   000000   02....       LJMP    ?BRET
    448          
    449          /*******************************************************************************
    450           * @fn      TransmitApp_MessageMSGCB
    451           *
    452           * @brief   Data message processor callback.  This function processes
    453           *          any incoming data - probably from other devices.  So, based
    454           *          on cluster ID, perform the intended action.
    455           *
    456           * @param   none
    457           *
    458           * @return  none
    459           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    460          void TransmitApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
   \                     TransmitApp_MessageMSGCB:
    461          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    462            switch ( pkt->clusterId )
    463            {
    464              case TRANSMITAPP_CLUSTERID_TESTMSG:
    465                break;
    466          
    467              // Could receive control messages in the future.
    468              default:
    469                break;
    470            }
    471          }
   \   000000   02....       LJMP    ?BRET
    472          
    473          /*******************************************************************************
    474           * @fn      TransmitApp_SendTheMessage
    475           *
    476           * @brief   Send "the" message.
    477           *
    478           * @param   none
    479           *
    480           * @return  none
    481           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    482          void TransmitApp_SendTheMessage( void )
   \                     TransmitApp_SendTheMessage:
    483          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 13
   \   000005   74F3         MOV     A,#-0xd
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    484            uint8 tmp;
    485            static uint8 dataNewBuf[4];
    486            
    487            uint16 light, temp;
    488            uint8 TxData[8];
    489            char buf[5];
    490          
    491            light = BH1750_ConvertLight();
   \   00000A                ; Setup parameters for call to function BH1750_ConvertLight
   \   00000A   12....       LCALL   ??BH1750_ConvertLight?relay
   \   00000D   8A..         MOV     ?V0 + 2,R2
   \   00000F   8B..         MOV     ?V0 + 3,R3
    492            temp  = DS18B20_ConvertTemp();
   \   000011                ; Setup parameters for call to function DS18B20_ConvertTemp
   \   000011   12....       LCALL   ??DS18B20_ConvertTemp?relay
   \   000014   8A..         MOV     ?V0 + 4,R2
   \   000016   8B..         MOV     ?V0 + 5,R3
   \   000018   8A..         MOV     ?V0 + 0,R2
    493            dataNewBuf[0] = (uint8)((temp >> 4) & 0x007F);// 温度的整数部分
   \   00001A   7404         MOV     A,#0x4
   \   00001C   78..         MOV     R0,#?V0 + 4
   \   00001E   12....       LCALL   ?US_SHR
   \   000021   AE..         MOV     R6,?V0 + 4
   \   000023   EE           MOV     A,R6
   \   000024   547F         ANL     A,#0x7f
   \   000026   90....       MOV     DPTR,#??dataNewBuf
   \   000029   F0           MOVX    @DPTR,A
    494            dataNewBuf[1] = (uint8)(temp & 0x000F);       // 温度的小数部分
   \   00002A   EA           MOV     A,R2
   \   00002B   540F         ANL     A,#0xf
   \   00002D   A3           INC     DPTR
   \   00002E   F0           MOVX    @DPTR,A
    495            dataNewBuf[2] = (uint8)(light >> 8);          // 光照度的高8位
   \   00002F   E5..         MOV     A,?V0 + 3
   \   000031   A3           INC     DPTR
   \   000032   F0           MOVX    @DPTR,A
    496            dataNewBuf[3] = (uint8)(light & 0xFF);        // 光照度的低8位
   \   000033   E5..         MOV     A,?V0 + 2
   \   000035   A3           INC     DPTR
   \   000036   F0           MOVX    @DPTR,A
    497                  
    498          #if HAL_UART==TRUE
    499            _ltoa(light, (uint8 *)buf, 10);
   \   000037                ; Setup parameters for call to function _ltoa
   \   000037   7408         MOV     A,#0x8
   \   000039   12....       LCALL   ?XSTACK_DISP0_8
   \   00003C   8582..       MOV     ?V0 + 4,DPL
   \   00003F   8583..       MOV     ?V0 + 5,DPH
   \   000042   78..         MOV     R0,#?V0 + 4
   \   000044   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000047   790A         MOV     R1,#0xa
   \   000049   AA..         MOV     R2,?V0 + 2
   \   00004B   AB..         MOV     R3,?V0 + 3
   \   00004D   E4           CLR     A
   \   00004E   FC           MOV     R4,A
   \   00004F   FD           MOV     R5,A
   \   000050   12....       LCALL   ??_ltoa?relay
   \   000053   7402         MOV     A,#0x2
   \   000055   12....       LCALL   ?DEALLOC_XSTACK8
    500            HalUARTWrite(HAL_UART_PORT_0, (uint8 *)buf, strlen(buf));
   \   000058                ; Setup parameters for call to function HalUARTWrite
   \   000058                ; Setup parameters for call to function strlen
   \   000058   7408         MOV     A,#0x8
   \   00005A   12....       LCALL   ?XSTACK_DISP0_8
   \   00005D   AA82         MOV     R2,DPL
   \   00005F   AB83         MOV     R3,DPH
   \   000061   12....       LCALL   ??strlen?relay
   \   000064   EA           MOV     A,R2
   \   000065   FC           MOV     R4,A
   \   000066   EB           MOV     A,R3
   \   000067   FD           MOV     R5,A
   \   000068   7408         MOV     A,#0x8
   \   00006A   12....       LCALL   ?XSTACK_DISP0_8
   \   00006D   AA82         MOV     R2,DPL
   \   00006F   AB83         MOV     R3,DPH
   \   000071   7900         MOV     R1,#0x0
   \   000073   12....       LCALL   ??HalUARTWrite?relay
    501            HalUARTWrite(HAL_UART_PORT_0, "L\n", strlen("L\n"));
   \   000076                ; Setup parameters for call to function HalUARTWrite
   \   000076   7C02         MOV     R4,#0x2
   \   000078   7D00         MOV     R5,#0x0
   \   00007A   7A..         MOV     R2,#`?<Constant "L\\n">` & 0xff
   \   00007C   7B..         MOV     R3,#(`?<Constant "L\\n">` >> 8) & 0xff
   \   00007E   7900         MOV     R1,#0x0
   \   000080   12....       LCALL   ??HalUARTWrite?relay
    502          
    503            _ltoa(((temp >> 4) & 0x007F), TxData, 10); // 整数部分
   \   000083                ; Setup parameters for call to function _ltoa
   \   000083   85..82       MOV     DPL,?XSP + 0
   \   000086   85..83       MOV     DPH,?XSP + 1
   \   000089   8582..       MOV     ?V0 + 2,DPL
   \   00008C   8583..       MOV     ?V0 + 3,DPH
   \   00008F   78..         MOV     R0,#?V0 + 2
   \   000091   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000094   790A         MOV     R1,#0xa
   \   000096   EE           MOV     A,R6
   \   000097   547F         ANL     A,#0x7f
   \   000099   F5..         MOV     ?V0 + 2,A
   \   00009B   E4           CLR     A
   \   00009C   AA..         MOV     R2,?V0 + 2
   \   00009E   FB           MOV     R3,A
   \   00009F   FC           MOV     R4,A
   \   0000A0   FD           MOV     R5,A
   \   0000A1   12....       LCALL   ??_ltoa?relay
   \   0000A4   7402         MOV     A,#0x2
   \   0000A6   12....       LCALL   ?DEALLOC_XSTACK8
    504            HalUARTWrite(HAL_UART_PORT_0, TxData, strlen((char *)TxData));
   \   0000A9                ; Setup parameters for call to function HalUARTWrite
   \   0000A9                ; Setup parameters for call to function strlen
   \   0000A9   12....       LCALL   ?Subroutine0 & 0xFFFF
    505            HalUARTWrite(HAL_UART_PORT_0, ".", strlen("."));
   \                     ??CrossCallReturnLabel_0:
   \   0000AC                ; Setup parameters for call to function HalUARTWrite
   \   0000AC   7C01         MOV     R4,#0x1
   \   0000AE   7D00         MOV     R5,#0x0
   \   0000B0   7A..         MOV     R2,#`?<Constant ".">` & 0xff
   \   0000B2   7B..         MOV     R3,#(`?<Constant ".">` >> 8) & 0xff
   \   0000B4   7900         MOV     R1,#0x0
   \   0000B6   12....       LCALL   ??HalUARTWrite?relay
    506            _ltoa((long)((float)(temp & 0x000F) * 62.5), TxData, 10);  // 小数部分
   \   0000B9                ; Setup parameters for call to function _ltoa
   \   0000B9   85..82       MOV     DPL,?XSP + 0
   \   0000BC   8582..       MOV     ?V0 + 2,DPL
   \   0000BF   78..         MOV     R0,#?V0 + 2
   \   0000C1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C4   E5..         MOV     A,?V0 + 0
   \   0000C6   540F         ANL     A,#0xf
   \   0000C8   F5..         MOV     ?V0 + 0,A
   \   0000CA   E4           CLR     A
   \   0000CB   F5..         MOV     ?V0 + 1,A
   \   0000CD   F5..         MOV     ?V0 + 2,A
   \   0000CF   F5..         MOV     ?V0 + 3,A
   \   0000D1   78..         MOV     R0,#?V0 + 0
   \   0000D3   12....       LCALL   ?UL_TO_FLT
   \   0000D6   90....       MOV     DPTR,#__Constant_427a0000
   \   0000D9   78..         MOV     R0,#?V0 + 4
   \   0000DB   12....       LCALL   ?L_MOV_X
   \   0000DE   78..         MOV     R0,#?V0 + 0
   \   0000E0   79..         MOV     R1,#?V0 + 4
   \   0000E2   12....       LCALL   ?FLT_MUL
   \   0000E5   78..         MOV     R0,#?V0 + 0
   \   0000E7   12....       LCALL   ?FLT_TO_L
   \   0000EA   AA..         MOV     R2,?V0 + 0
   \   0000EC   AB..         MOV     R3,?V0 + 1
   \   0000EE   AC..         MOV     R4,?V0 + 2
   \   0000F0   AD..         MOV     R5,?V0 + 3
   \   0000F2   740A         MOV     A,#0xa
   \   0000F4   F9           MOV     R1,A
   \   0000F5   12....       LCALL   ??_ltoa?relay
   \   0000F8   7402         MOV     A,#0x2
   \   0000FA   12....       LCALL   ?DEALLOC_XSTACK8
    507            HalUARTWrite(HAL_UART_PORT_0, TxData, strlen((char *)TxData));
   \   0000FD                ; Setup parameters for call to function HalUARTWrite
   \   0000FD                ; Setup parameters for call to function strlen
   \   0000FD   12....       LCALL   ?Subroutine0 & 0xFFFF
    508            HalUARTWrite(HAL_UART_PORT_0, "C\n", strlen("C\n"));
   \                     ??CrossCallReturnLabel_1:
   \   000100                ; Setup parameters for call to function HalUARTWrite
   \   000100   7C02         MOV     R4,#0x2
   \   000102   7D00         MOV     R5,#0x0
   \   000104   7A..         MOV     R2,#`?<Constant "C\\n">` & 0xff
   \   000106   7B..         MOV     R3,#(`?<Constant "C\\n">` >> 8) & 0xff
   \   000108   7900         MOV     R1,#0x0
   \   00010A   12....       LCALL   ??HalUARTWrite?relay
    509          #endif  
    510              
    511            do {
    512                // put the sequence number in the message
    513                tmp = HI_UINT8( TransmitApp_TransID );
   \                     ??TransmitApp_SendTheMessage_0:
   \   00010D   90....       MOV     DPTR,#TransmitApp_TransID
   \   000110   E0           MOVX    A,@DPTR
   \   000111   C4           SWAP    A
   \   000112   540F         ANL     A,#0xf
   \   000114   FA           MOV     R2,A
    514                tmp += (tmp <= 9) ? ('0') : ('A' - 0x0A);
   \   000115   C3           CLR     C
   \   000116   940A         SUBB    A,#0xa
   \   000118   5004         JNC     ??TransmitApp_SendTheMessage_1
   \   00011A   7830         MOV     R0,#0x30
   \   00011C   8002         SJMP    ??TransmitApp_SendTheMessage_2
   \                     ??TransmitApp_SendTheMessage_1:
   \   00011E   7837         MOV     R0,#0x37
    515                TransmitApp_Msg[2] = tmp;
   \                     ??TransmitApp_SendTheMessage_2:
   \   000120   E8           MOV     A,R0
   \   000121   2A           ADD     A,R2
   \   000122   90....       MOV     DPTR,#TransmitApp_Msg + 2
   \   000125   F0           MOVX    @DPTR,A
    516                tmp = LO_UINT8( TransmitApp_TransID );
   \   000126   90....       MOV     DPTR,#TransmitApp_TransID
   \   000129   E0           MOVX    A,@DPTR
   \   00012A   540F         ANL     A,#0xf
   \   00012C   FA           MOV     R2,A
    517                tmp += (tmp <= 9) ? ('0') : ('A' - 0x0A);
   \   00012D   C3           CLR     C
   \   00012E   940A         SUBB    A,#0xa
   \   000130   5004         JNC     ??TransmitApp_SendTheMessage_3
   \   000132   7830         MOV     R0,#0x30
   \   000134   8002         SJMP    ??TransmitApp_SendTheMessage_4
   \                     ??TransmitApp_SendTheMessage_3:
   \   000136   7837         MOV     R0,#0x37
    518                TransmitApp_Msg[3] = tmp;
   \                     ??TransmitApp_SendTheMessage_4:
   \   000138   E8           MOV     A,R0
   \   000139   2A           ADD     A,R2
   \   00013A   90....       MOV     DPTR,#TransmitApp_Msg + 3
   \   00013D   F0           MOVX    @DPTR,A
    519                TransmitApp_Msg[4] = dataNewBuf[0];
   \   00013E   90....       MOV     DPTR,#??dataNewBuf
   \   000141   E0           MOVX    A,@DPTR
   \   000142   90....       MOV     DPTR,#TransmitApp_Msg + 4
   \   000145   F0           MOVX    @DPTR,A
    520                TransmitApp_Msg[5] = dataNewBuf[1];
   \   000146   90....       MOV     DPTR,#??dataNewBuf + 1
   \   000149   E0           MOVX    A,@DPTR
   \   00014A   90....       MOV     DPTR,#TransmitApp_Msg + 5
   \   00014D   F0           MOVX    @DPTR,A
    521                TransmitApp_Msg[6] = dataNewBuf[2];
   \   00014E   90....       MOV     DPTR,#??dataNewBuf + 2
   \   000151   E0           MOVX    A,@DPTR
   \   000152   90....       MOV     DPTR,#TransmitApp_Msg + 6
   \   000155   F0           MOVX    @DPTR,A
    522                TransmitApp_Msg[7] = dataNewBuf[3];
   \   000156   90....       MOV     DPTR,#??dataNewBuf + 3
   \   000159   E0           MOVX    A,@DPTR
   \   00015A   90....       MOV     DPTR,#TransmitApp_Msg + 7
   \   00015D   F0           MOVX    @DPTR,A
    523                
    524                tmp = AF_DataRequest( &TransmitApp_DstAddr, 
    525                                      &TransmitApp_epDesc,
    526                                       TRANSMITAPP_CLUSTERID_TEMPLIGHTMSG,
    527                                       TRANSMITAPP_TEMPLIGHT_DATA_LEN, 
    528                                       TransmitApp_Msg,
    529                                      &TransmitApp_TransID,
    530                                       TRANSMITAPP_TX_OPTIONS,
    531                                       AF_DEFAULT_RADIUS );
    532          
    533            } while (afStatus_SUCCESS == tmp);
   \   00015E                ; Setup parameters for call to function AF_DataRequest
   \   00015E   75..1E       MOV     ?V0 + 0,#0x1e
   \   000161   78..         MOV     R0,#?V0 + 0
   \   000163   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000166   75....       MOV     ?V0 + 0,#TransmitApp_TransID & 0xff
   \   000169   75....       MOV     ?V0 + 1,#(TransmitApp_TransID >> 8) & 0xff
   \   00016C   78..         MOV     R0,#?V0 + 0
   \   00016E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000171   75....       MOV     ?V0 + 0,#TransmitApp_Msg & 0xff
   \   000174   75....       MOV     ?V0 + 1,#(TransmitApp_Msg >> 8) & 0xff
   \   000177   78..         MOV     R0,#?V0 + 0
   \   000179   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00017C   75..08       MOV     ?V0 + 0,#0x8
   \   00017F   75..00       MOV     ?V0 + 1,#0x0
   \   000182   78..         MOV     R0,#?V0 + 0
   \   000184   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000187   75..02       MOV     ?V0 + 0,#0x2
   \   00018A   78..         MOV     R0,#?V0 + 0
   \   00018C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00018F   7920         MOV     R1,#0x20
   \   000191   7C..         MOV     R4,#TransmitApp_epDesc & 0xff
   \   000193   7D..         MOV     R5,#(TransmitApp_epDesc >> 8) & 0xff
   \   000195   7A..         MOV     R2,#TransmitApp_DstAddr & 0xff
   \   000197   7B..         MOV     R3,#(TransmitApp_DstAddr >> 8) & 0xff
   \   000199   12....       LCALL   ??AF_DataRequest?relay
   \   00019C   7409         MOV     A,#0x9
   \   00019E   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001A1   E9           MOV     A,R1
   \   0001A2   7003         JNZ     $+5
   \   0001A4   02....       LJMP    ??TransmitApp_SendTheMessage_0 & 0xFFFF
    534          
    535          }
   \   0001A7   740D         MOV     A,#0xd
   \   0001A9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001AC   7F08         MOV     R7,#0x8
   \   0001AE   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   AA82         MOV     R2,DPL
   \   000008   AB83         MOV     R3,DPH
   \   00000A   12....       LCALL   ??strlen?relay
   \   00000D   EA           MOV     A,R2
   \   00000E   FC           MOV     R4,A
   \   00000F   EB           MOV     A,R3
   \   000010   FD           MOV     R5,A
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   AA82         MOV     R2,DPL
   \   000019   AB83         MOV     R3,DPH
   \   00001B   7900         MOV     R1,#0x0
   \   00001D   12....       LCALL   ??HalUARTWrite?relay
   \   000020   22           RET

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??dataNewBuf:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z
    536          
    537          /*******************************************************************************
    538           * @fn      TransmitApp_ChangeState
    539           *
    540           * @brief   Toggle the Sending/Waiting state flag
    541           *
    542           * @param   none
    543           *
    544           * @return  none
    545           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    546          void TransmitApp_ChangeState( void )
   \                     TransmitApp_ChangeState:
    547          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    548          }
   \   000000   02....       LJMP    ?BRET
    549          
    550          /*******************************************************************************
    551           * @fn      TransmitApp_SetSendEvt
    552           *
    553           * @brief   Set the event flag
    554           *
    555           * @param   none
    556           *
    557           * @return  none
    558           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    559          void TransmitApp_SetSendEvt( void )
   \                     TransmitApp_SetSendEvt:
    560          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    561          
    562          }
   \   000000   02....       LJMP    ?BRET
    563          
    564          /*******************************************************************************
    565           * @fn      TransmitApp_DisplayResults
    566           *
    567           * @brief   Display the results and clear the accumulators
    568           *
    569           * @param   none
    570           *
    571           * @return  none
    572           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    573          void TransmitApp_DisplayResults( void )
   \                     TransmitApp_DisplayResults:
    574          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    575          
    576          }
   \   000000   02....       LJMP    ?BRET
    577          
    578          /*******************************************************************************
    579           * @fn      TransmitAPP_CallBack
    580           *
    581           * @brief   Send data OTA.
    582           *
    583           * @param   port - UART port.
    584           * @param   event - the UART port event flag.
    585           *
    586           * @return  none
    587           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    588          static void TransmitAPP_CallBack(uint8 port, uint8 event)
   \                     TransmitAPP_CallBack:
    589          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    590          
    591          }
   \   000000   02....       LJMP    ?BRET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_ProcessZDOMsgs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_ProcessZDOMsgs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_MessageMSGCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_SendTheMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_SendTheMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_ChangeState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_ChangeState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_SetSendEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_SetSendEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitApp_DisplayResults?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitApp_DisplayResults

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??TransmitAPP_CallBack?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    TransmitAPP_CallBack

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Match Success!\\n">`:
   \   000000   4D617463     DB "Match Success!\012"
   \            68205375
   \            63636573
   \            73210A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "L\\n">`:
   \   000000   4C0A00       DB "L\012"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant ".">`:
   \   000000   2E00         DB "."

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "C\\n">`:
   \   000000   430A00       DB "C\012"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_427a0000:
   \   000000   00007A42     DD 427A0000H

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     TransmitAPP_CallBack               0      0      0
     TransmitApp_ChangeState            0      0      0
     TransmitApp_DisplayResults         0      0      0
     TransmitApp_HandleKeys             0      0      0
     TransmitApp_Init                   0      0     38
       -> HalUARTOpen                   0      0     76
       -> afRegister                    0      0     76
       -> RegisterForKeys               0      0     76
       -> ZDO_RegisterForZDOMsg         0      0     76
       -> ZDO_RegisterForZDOMsg         0      0     76
       -> osal_start_reload_timer       0      0     76
     TransmitApp_MessageMSGCB           0      0      0
     TransmitApp_ProcessEvent           0      0     29
       -> osal_msg_receive              0      0     42
       -> osal_msg_deallocate           0      0     42
       -> osal_msg_receive              0      0     42
       -> TransmitApp_ProcessZDOMsgs
                                        0      0     42
       -> TransmitApp_SendTheMessage
                                        0      0     42
       -> ZDP_MatchDescReq              0      0     58
     TransmitApp_ProcessZDOMsgs         0      0     31
       -> ZDO_ParseEPListRsp            0      0     20
       -> osal_stop_timerEx             0      0     20
       -> HalUARTWrite                  0      0     20
       -> osal_start_reload_timer       0      0     20
       -> osal_mem_free                 0      0     20
     TransmitApp_SendTheMessage         0      0     59
       -> BH1750_ConvertLight           0      0     58
       -> DS18B20_ConvertTemp           0      0     58
       -> _ltoa                         0      0     62
       -> strlen                        0      0     58
       -> HalUARTWrite                  0      0     58
       -> HalUARTWrite                  0      0     58
       -> _ltoa                         0      0     62
       -> strlen                        0      0     58
       -> HalUARTWrite                  0      0     58
       -> HalUARTWrite                  0      0     58
       -> _ltoa                         0      0     62
       -> strlen                        0      0     58
       -> HalUARTWrite                  0      0     58
       -> HalUARTWrite                  0      0     58
       -> AF_DataRequest                0      0     76
     TransmitApp_SetSendEvt             0      0      0


   Segment part sizes:

     Function/Label                     Bytes
     --------------                     -----
     TransmitApp_Msg                       8
     TransmitApp_InClusterList             2
     TransmitApp_OutClusterList            2
     TransmitApp_SimpleDesc               12
     TransmitApp_epDesc                    6
     TransmitApp_TaskID                    1
     TransmitApp_NwkState                  1
     TransmitApp_TransID                   1
     TransmitApp_DstAddr                  12
     TransmitApp_Init                    234
     TransmitApp_ProcessEvent            224
     TransmitApp_ProcessZDOMsgs          144
     TransmitApp_HandleKeys                3
     TransmitApp_MessageMSGCB              3
     TransmitApp_SendTheMessage          433
     ?Subroutine0                         33
     dataNewBuf                            4
     TransmitApp_ChangeState               3
     TransmitApp_SetSendEvt                3
     TransmitApp_DisplayResults            3
     TransmitAPP_CallBack                  3
     ??TransmitApp_Init?relay              6
     ??TransmitApp_ProcessEvent?relay      6
     ??TransmitApp_ProcessZDOMsgs?relay    6
     ??TransmitApp_HandleKeys?relay        6
     ??TransmitApp_MessageMSGCB?relay      6
     ??TransmitApp_SendTheMessage?relay    6
     ??TransmitApp_ChangeState?relay       6
     ??TransmitApp_SetSendEvt?relay        6
     ??TransmitApp_DisplayResults?relay    6
     ??TransmitAPP_CallBack?relay          6
     ?<Constant "Match Success!\n">       16
     ?<Constant "L\n">                     3
     ?<Constant ".">                       2
     ?<Constant "C\n">                     3
     __Constant_427a0000                   4

 
 1 086 bytes in segment BANKED_CODE
    60 bytes in segment BANK_RELAYS
    44 bytes in segment XDATA_ROM_C
    33 bytes in segment XDATA_Z
 
 1 146 bytes of CODE  memory
    40 bytes of CONST memory (+ 4 bytes shared)
    33 bytes of XDATA memory

Errors: none
Warnings: 2
